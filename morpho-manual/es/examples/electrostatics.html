<!DOCTYPE HTML>
<html lang="es" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Electrostática - Morpho Manual</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/css/language-picker.css">

        <!-- MathJax -->
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
            TeX: { 
                equationNumbers: { 
                    autoNumber: "AMS",
                }
            }
        });
        </script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../foreword.html">Introducción</a></li><li class="chapter-item "><a href="../overview.html"><strong aria-hidden="true">1.</strong> Descripción general</a></li><li class="chapter-item "><a href="../installing_morpho.html"><strong aria-hidden="true">2.</strong> Instalación de Morpho</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../installing/homebrew.html"><strong aria-hidden="true">2.1.</strong> Instalación via homebrew</a></li><li class="chapter-item "><a href="../installing/source.html"><strong aria-hidden="true">2.2.</strong> Instalación con el código fuente</a></li><li class="chapter-item "><a href="../installing/wsl.html"><strong aria-hidden="true">2.3.</strong> Windows a través del subsistema de Windows para Linux (WSL)</a></li><li class="chapter-item "><a href="../installing/updating.html"><strong aria-hidden="true">2.4.</strong> Actualización de morpho</a></li><li class="chapter-item "><a href="../installing/uninstalling.html"><strong aria-hidden="true">2.5.</strong> Desinstalación de morpho</a></li></ol></li><li class="chapter-item "><a href="../using_morpho.html"><strong aria-hidden="true">3.</strong> Usando Morpho</a></li><li class="chapter-item "><a href="../tutorial.html"><strong aria-hidden="true">4.</strong> Tutorial</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tutorial/importing_modules.html"><strong aria-hidden="true">4.1.</strong> Importación de módulos</a></li><li class="chapter-item "><a href="../tutorial/morpho_language.html"><strong aria-hidden="true">4.2.</strong> El lenguaje Morpho</a></li><li class="chapter-item "><a href="../tutorial/creating_the_initial_mesh.html"><strong aria-hidden="true">4.3.</strong> Creación de la malla inicial</a></li><li class="chapter-item "><a href="../tutorial/selections.html"><strong aria-hidden="true">4.4.</strong> Selecciones</a></li><li class="chapter-item "><a href="../tutorial/fields.html"><strong aria-hidden="true">4.5.</strong> Campos</a></li><li class="chapter-item "><a href="../tutorial/defining_the_problem.html"><strong aria-hidden="true">4.6.</strong> Definición del problema</a></li><li class="chapter-item "><a href="../tutorial/performing_the_optimization.html"><strong aria-hidden="true">4.7.</strong> Realizando la optimización</a></li><li class="chapter-item "><a href="../tutorial/visualizing_the_results.html"><strong aria-hidden="true">4.8.</strong> Visualización de los resultados</a></li><li class="chapter-item "><a href="../tutorial/refinement.html"><strong aria-hidden="true">4.9.</strong> Refinamiento</a></li><li class="chapter-item "><a href="../tutorial/next_steps.html"><strong aria-hidden="true">4.10.</strong> Siguientes pasos</a></li></ol></li><li class="chapter-item "><a href="../working_with_meshes.html"><strong aria-hidden="true">5.</strong> Trabajando con mallas</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../working_with_meshes/meshgen_module.html"><strong aria-hidden="true">5.1.</strong> El módulo meshgen</a></li><li class="chapter-item "><a href="../working_with_meshes/meshtools_module.html"><strong aria-hidden="true">5.2.</strong> El módulo meshtools</a></li><li class="chapter-item "><a href="../working_with_meshes/vtk_module.html"><strong aria-hidden="true">5.3.</strong> El módulo vtk</a></li><li class="chapter-item "><a href="../working_with_meshes/merging_meshes.html"><strong aria-hidden="true">5.4.</strong> Uniendo mallas</a></li><li class="chapter-item "><a href="../working_with_meshes/slicing_meshes.html"><strong aria-hidden="true">5.5.</strong> Seleccionando mallas</a></li></ol></li><li class="chapter-item "><a href="../visualization.html"><strong aria-hidden="true">6.</strong> Visualización</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../visualization/plot_module.html"><strong aria-hidden="true">6.1.</strong> El módulo de visualización</a></li><li class="chapter-item "><a href="../visualization/graphics_module.html"><strong aria-hidden="true">6.2.</strong> El módulo de gráficos</a></li><li class="chapter-item "><a href="../visualization/povray_module.html"><strong aria-hidden="true">6.3.</strong> El módulo povray</a></li></ol></li><li class="chapter-item expanded "><a href="../examples.html"><strong aria-hidden="true">7.</strong> Ejemplos</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../examples/catenoid.html"><strong aria-hidden="true">7.1.</strong> Catenoide</a></li><li class="chapter-item "><a href="../examples/cholesteric.html"><strong aria-hidden="true">7.2.</strong> Colestérico</a></li><li class="chapter-item "><a href="../examples/cube.html"><strong aria-hidden="true">7.3.</strong> Cubo</a></li><li class="chapter-item "><a href="../examples/delaunay.html"><strong aria-hidden="true">7.4.</strong> Delaunay</a></li><li class="chapter-item "><a href="../examples/dla.html"><strong aria-hidden="true">7.5.</strong> DLA</a></li><li class="chapter-item expanded "><a href="../examples/electrostatics.html" class="active"><strong aria-hidden="true">7.6.</strong> Electrostática</a></li><li class="chapter-item "><a href="../examples/implicitmesh.html"><strong aria-hidden="true">7.7.</strong> Implicitmesh</a></li><li class="chapter-item "><a href="../examples/meshgen.html"><strong aria-hidden="true">7.8.</strong> Meshgen</a></li><li class="chapter-item "><a href="../examples/meshslice.html"><strong aria-hidden="true">7.9.</strong> Meshslice</a></li><li class="chapter-item "><a href="../examples/plot.html"><strong aria-hidden="true">7.10.</strong> Plot</a></li><li class="chapter-item "><a href="../examples/povray.html"><strong aria-hidden="true">7.11.</strong> Povray</a></li><li class="chapter-item "><a href="../examples/qtensor.html"><strong aria-hidden="true">7.12.</strong> QTensor</a></li><li class="chapter-item "><a href="../examples/thomson.html"><strong aria-hidden="true">7.13.</strong> Thomson</a></li><li class="chapter-item "><a href="../examples/wrap.html"><strong aria-hidden="true">7.14.</strong> Envolver</a></li></ol></li><li class="chapter-item "><a href="../reference.html"><strong aria-hidden="true">8.</strong> Referencias</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../reference/language.html"><strong aria-hidden="true">8.1.</strong> Idioma</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../reference/nested/syntax.html"><strong aria-hidden="true">8.1.1.</strong> Sintaxis</a></li><li class="chapter-item "><a href="../reference/nested/values.html"><strong aria-hidden="true">8.1.2.</strong> Valores</a></li><li class="chapter-item "><a href="../reference/nested/variables.html"><strong aria-hidden="true">8.1.3.</strong> Variables</a></li><li class="chapter-item "><a href="../reference/nested/controlflow.html"><strong aria-hidden="true">8.1.4.</strong> Flujo de control</a></li><li class="chapter-item "><a href="../reference/nested/functions.html"><strong aria-hidden="true">8.1.5.</strong> Funciones</a></li><li class="chapter-item "><a href="../reference/nested/classes.html"><strong aria-hidden="true">8.1.6.</strong> Clases</a></li><li class="chapter-item "><a href="../reference/nested/modules.html"><strong aria-hidden="true">8.1.7.</strong> Módulos</a></li><li class="chapter-item "><a href="../reference/nested/help.html"><strong aria-hidden="true">8.1.8.</strong> Ayuda</a></li><li class="chapter-item "><a href="../reference/nested/errors.html"><strong aria-hidden="true">8.1.9.</strong> Errores</a></li><li class="chapter-item "><a href="../reference/nested/builtin.html"><strong aria-hidden="true">8.1.10.</strong> Funciones integradas</a></li></ol></li><li class="chapter-item "><a href="../reference/data_types.html"><strong aria-hidden="true">8.2.</strong> Tipos de datos</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../reference/nested/array.html"><strong aria-hidden="true">8.2.1.</strong> Array</a></li><li class="chapter-item "><a href="../reference/nested/complex.html"><strong aria-hidden="true">8.2.2.</strong> Complejo</a></li><li class="chapter-item "><a href="../reference/nested/list.html"><strong aria-hidden="true">8.2.3.</strong> Lista</a></li><li class="chapter-item "><a href="../reference/nested/matrix.html"><strong aria-hidden="true">8.2.4.</strong> Matriz</a></li><li class="chapter-item "><a href="../reference/nested/range.html"><strong aria-hidden="true">8.2.5.</strong> Rango</a></li><li class="chapter-item "><a href="../reference/nested/sparse.html"><strong aria-hidden="true">8.2.6.</strong> Sparse</a></li><li class="chapter-item "><a href="../reference/nested/string.html"><strong aria-hidden="true">8.2.7.</strong> Cuerda (String)</a></li><li class="chapter-item "><a href="../reference/nested/tuple.html"><strong aria-hidden="true">8.2.8.</strong> Tupla</a></li></ol></li><li class="chapter-item "><a href="../reference/computational_geometry.html"><strong aria-hidden="true">8.3.</strong> Geometría Computacional</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../reference/nested/field.html"><strong aria-hidden="true">8.3.1.</strong> Campo</a></li><li class="chapter-item "><a href="../reference/nested/functionals.html"><strong aria-hidden="true">8.3.2.</strong> Funcionales</a></li><li class="chapter-item "><a href="../reference/nested/mesh.html"><strong aria-hidden="true">8.3.3.</strong> Malla</a></li><li class="chapter-item "><a href="../reference/nested/selection.html"><strong aria-hidden="true">8.3.4.</strong> Selección</a></li></ol></li><li class="chapter-item "><a href="../reference/io.html"><strong aria-hidden="true">8.4.</strong> E/S</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../reference/nested/file.html"><strong aria-hidden="true">8.4.1.</strong> Archivo</a></li><li class="chapter-item "><a href="../reference/nested/json.html"><strong aria-hidden="true">8.4.2.</strong> JSON</a></li></ol></li><li class="chapter-item "><a href="../reference/modules.html"><strong aria-hidden="true">8.5.</strong> Módulos</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../reference/nested/color.html"><strong aria-hidden="true">8.5.1.</strong> Color</a></li><li class="chapter-item "><a href="../reference/nested/constants.html"><strong aria-hidden="true">8.5.2.</strong> Constantes</a></li><li class="chapter-item "><a href="../reference/nested/delaunay.html"><strong aria-hidden="true">8.5.3.</strong> Delaunay</a></li><li class="chapter-item "><a href="../reference/nested/graphics.html"><strong aria-hidden="true">8.5.4.</strong> Gráficos</a></li><li class="chapter-item "><a href="../reference/nested/implicitmesh.html"><strong aria-hidden="true">8.5.5.</strong> Implicitmesh</a></li><li class="chapter-item "><a href="../reference/nested/kdtree.html"><strong aria-hidden="true">8.5.6.</strong> KDTree</a></li><li class="chapter-item "><a href="../reference/nested/meshgen.html"><strong aria-hidden="true">8.5.7.</strong> MeshGen</a></li><li class="chapter-item "><a href="../reference/nested/meshslice.html"><strong aria-hidden="true">8.5.8.</strong> Meshslice</a></li><li class="chapter-item "><a href="../reference/nested/meshtools.html"><strong aria-hidden="true">8.5.9.</strong> Meshtools</a></li><li class="chapter-item "><a href="../reference/nested/optimize.html"><strong aria-hidden="true">8.5.10.</strong> Optimizar</a></li><li class="chapter-item "><a href="../reference/nested/plot.html"><strong aria-hidden="true">8.5.11.</strong> Plot</a></li><li class="chapter-item "><a href="../reference/nested/povray.html"><strong aria-hidden="true">8.5.12.</strong> POVRay</a></li><li class="chapter-item "><a href="../reference/nested/vtk.html"><strong aria-hidden="true">8.5.13.</strong> VTK</a></li><li class="spacer"></li></ol></li></ol></li><li class="chapter-item "><a href="../mdbook_notes.html">Acerca de esta versión en línea</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Morpho Manual</h1>

                    <div class="right-buttons">
                        <button id="language-toggle" class="icon-button" type="button"
                                title="Change language" aria-label="Change language"
                                aria-haspopup="true" aria-expanded="false"
                                aria-controls="language-list">
                            <i class="fa fa-globe"></i>
                        </button>
                        <ul id="language-list" class="theme-popup" aria-label="Languages" role="menu">
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="en">English</a>
                          </button></li>
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="es">Spanish (Español)</a>
                          </button></li>
                        </ul>
                        <script>
                          let langToggle = document.getElementById("language-toggle");
                          let langList = document.getElementById("language-list");
                          langToggle.addEventListener("click", (event) => {
                              langList.style.display = langList.style.display == "block" ? "none" : "block";
                          });
                          let selectedLang = document.getElementById("es");
                          selectedLang.parentNode.classList.add("theme-selected");

                          // The path to the root, taking the current
                          // language into account.
                          let full_path_to_root = "../../";
                          // The page path (mdbook only gives us
                          // access to the path to the Markdown file).
                          let path = "examples/electrostatics.md".replace(/\.md$/, ".html");
                          for (let lang of langList.querySelectorAll("a")) {
                              if (lang.id == "en") {
                                  lang.href = `${full_path_to_root}${path}`;
                              } else {
                                  lang.href = `${full_path_to_root}${lang.id}/${path}`;
                              }
                          }
                        </script>
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/joshichaitanya3/morpho-manual" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="electrostática"><a class="header" href="#electrostática">Electrostática</a></h2>
<p>Este ejemplo muestra cómo resolver un problema electrostático simple con refinamiento adaptativo y proporciona un ejemplo útil de cómo convertir un problema que normalmente se considera como la resolución de un PDE como un problema de optimización.</p>
<p>Supongamos que queremos resolver la ecuación de Laplace,</p>
<p>$$\nabla^{2}\phi=0$$</p>
<p>en un dominio cuadrado \(C\) definido por \(-L/2\leq x\leq L/2\) y \(-L/2\leq y\leq L/2\). Una formulación equivalente adecuada para <em>morpho</em> es minimizar,</p>
<p>$$ \begin{equation} \int_{C}\left|\nabla\phi\right|^{2}dA \label{eq:el1} \end{equation} $$</p>
<p>con respecto a \(\phi\).</p>
<p>Podemos demostrar que los dos son equivalentes aplicando el cálculo de variaciones a la \eqref{eq:el1},</p>
<p>$$ \delta\int*{C}\left|\nabla\phi\right|^{2}dA =\int*{C}\delta\left|\nabla\phi\right|^{2}dA $$ $$ =\int_{C}\frac{\partial}{\partial\nabla\phi}\left|\nabla\phi\right|^{2}\cdot\delta\nabla\phi dA,$$</p>
<p>e integrando por partes,</p>
<p>$$ \begin{align} \int_{C}\frac{\partial}{\partial\nabla\phi}\left|\nabla\phi\right|^{2}\cdot\delta\nabla\phi dA &amp; =\int_{\partial C}\nabla\phi\cdot\hat{\mathbf{s}}\delta\phi dl-\int_{C}\nabla\cdot\frac{\partial}{\partial\nabla\phi}\left|\nabla\phi\right|^{2}\delta\phi dA\nonumber \\ &amp; =\int_{\partial C}\nabla\phi\cdot\hat{\mathbf{s}}\delta\phi dl-\int_{C}\nabla^{2}\phi\delta\phi dA,\label{eq:bulkvariations} \end{align} $$</p>
<blockquote>
<p><strong>Nota</strong> Si no estás familiarizado con el cálculo de variaciones, siéntete libre de omitir los párrafos que se refieren a "variaciones". El cálculo de variaciones generaliza el cálculo de la diferenciación con respecto a las variables a la diferenciación con respecto a las funciones.</p>
</blockquote>
<p>donde \(\hat{\mathbf{s}}\) es la normal externa. Por lo tanto, permitiendo variaciones arbitrarias \(\delta\phi\), para que el integrando masivo desaparezca, la ecuación de Laplace \(\nabla^{2}\phi=0\) debe ser satisfecha. De manera similar, al requerir que el integrando de frontera desaparezca, se obtiene la condición de contorno "natural" \(\nabla\phi\cdot\hat{\mathbf{s}}=0\), conocida como la condición de contorno de Neumann. En ausencia de energías límite, la resolución de \(\nabla^{2}\phi=0\) en \(C\) sujeta a \(\nabla\phi\cdot\hat{\mathbf{s}}=0\) en \(\partial C\) produce la familia de soluciones constantes uniformes \(\phi=\text{const}.\)</p>
<p>Para imponer datos de límites, complementaremos \eqref{eq:el1} con la funcionalidad adicional,</p>
<p>$$ \begin{equation} \lambda\int_{\partial C}\left[\phi-\phi_{0}(\mathbf{x})\right]^{2}dl\label{eq:anchoring} \end{equation} $$</p>
<p>donde la función \(\phi_{0}\) representa algún potencial límite impuesto. Tomando variaciones de este funcional,</p>
<p>$$ \begin{align} \delta\lambda\int_{\partial C}\left[\phi-\phi_{0}(\mathbf{x})\right]^{2}dl &amp; =\lambda\int_{\partial C}\frac{\partial}{\partial\phi}\left[\phi-\phi_{0}(\mathbf{x})\right]^{2}\delta\phi dl\nonumber \\ &amp; =\lambda\int_{\partial C}2\left[\phi-\phi_{0}(\mathbf{x})\right]\delta\phi dl\label{eq:boundary} \end{align} $$</p>
<p>Recopilando los términos de frontera de \eqref{eq:bulkvariations} y \eqref{eq:boundary}, obtenemos la condición de frontera equivalente en \(\phi\), $$\nabla\phi\cdot\hat{\mathbf{s}}+2\lambda(\phi-\phi_{0})=0,$$ que se conoce como condición de límite de Robin. Como \(\lambda\to\infty\), \(\phi\to\phi_0\) en el límite, recuperando un límite fijo o condición de Dirichlet, mientras que como \(\lambda\to0\), recuperamos las condiciones de Neumann discutidas anteriormente.</p>
<p>En el ejemplo, estableceremos \(\phi_0=0\) en el límite izquierdo e inferior y \(\phi_0=1\) en el límite derecho y superior, y usaremos \(\lambda=100\).</p>
<p>El código ilustra algunos trucos de <em>morpho</em>. En primer lugar, se utiliza el siguiente código para seleccionar los lados izquierdo/inferior y superior/derecho de la malla:</p>
<pre><code>var bnd = Selection(mesh, boundary=true)
var bnd1 = Selection(mesh, fn (x,y,z) abs(x+L/2)&lt;0.01 || abs(y+L/2)&lt;0.01)
var bnd2 = Selection(mesh, fn (x,y,z) abs(x-L/2)&lt;0.01 || abs(y-L/2)&lt;0.01)
for (b in [bnd1, bnd2]) b.addgrade(1)
bnd1=bnd.intersection(bnd1)
bnd2=bnd.intersection(bnd2)
</code></pre>
<p>Lo que sucede aquí es que seleccionamos todo el límite en la primera línea y luego seleccionamos los vértices relevantes en las dos líneas siguientes. A continuación, los bordes se añaden a la selección con <code>addgrade</code>, pero esto también selecciona algunos bordes interiores. Para asegurarnos de que solo tenemos bordes de límite en nuestras selecciones, encontramos la intersección de <code>bnd1</code> y <code>bnd</code>, y de manera similar para <code>bnd2</code>.</p>
<p>La configuración del problema implica sumar la energía electrostática Eq.\eqref{eq:el1} usando <code>GradSq</code> y los términos de frontera Eq.\eqref{eq:anchoring} como 'LineIntegral's.</p>
<pre><code>var problem = OptimizationProblem(mesh)
var le = GradSq(phi)
problem.addenergy(le)
var v1 = 0, v2 = 1
var lt1 = LineIntegral(fn (x, v) (v-v1)^2, phi)
problem.addenergy(lt1, selection=bnd1, prefactor=100)
var lt2 = LineIntegral(fn (x, v) (v-v2)^2, phi)
problem.addenergy(lt2, selection=bnd2, prefactor=100)
</code></pre>
<p>La optimización se realiza con un <code>FieldOptimizer</code>:</p>
<pre><code>var opt = FieldOptimizer(problem, phi)
opt.conjugategradient(100)
</code></pre>
<p>El problema, tal como se plantea, requiere que \(\phi\) cambie muy bruscamente en las córneas superior izquierda e inferior derecha a medida que los cambios potenciales impuestos, pero lejos de estos \(\phi\) cambia mucho más lentamente. Por lo tanto, nos gustaría realizar un <em>refinamiento adaptativo</em>, refinando la malla solo en lugares donde \(\phi\) está cambiando rápidamente y usando elementos gruesos en otros lugares.</p>
<p>Para identificar los elementos que se van a refinar, calculamos la energía electrostática en cada elemento, usaremos esto como una medida heurística de la rapidez con la que \(\phi\) está cambiando y encontraremos la energía media por elemento. A continuación, creamos una selección y seleccionamos manualmente los elementos que tienen una energía electrostática superior a \(1,5\times\) la media.</p>
<pre><code>// Select elements that have an above average contribution to the energy
var en = le.integrand(phi) // energy in each element
var mean = en.sum()/en.count() // mean energy per element
var srefine = Selection(mesh)
for (id in 0…en.count()) if (en[0,id]&gt;1.5*mean) srefine[2,id]=true
// identify large contributions
</code></pre>
<p>A continuación, el refinamiento se realiza con un objeto MeshRefiner del módulo <code>meshtools</code>, que creamos con una lista tanto de la malla para refinar <em>y</em> todas las cantidades que hacen referencia a la malla:</p>
<pre><code>var ref = MeshRefiner([mesh, phi, bnd, bnd1, bnd2])
</code></pre>
<p>El refinamiento se realiza utilizando la selección <code>srefine</code> que se acaba de crear</p>
<pre><code>var refmap = ref.refine(selection=srefine)
</code></pre>
<p>que devuelve un diccionario que asigna las cantidades antiguas a las nuevas refinadas. Usamos este diccionario para actualizar OptimizationProblem y FieldOptimizer,</p>
<pre><code>for (el in [problem, opt]) el.update(refmap)
</code></pre>
<p>y finalmente actualizar nuestras variables</p>
<pre><code>mesh = refmap[mesh]
phi = refmap[phi]
bnd = refmap[bnd]
bnd1 = refmap[bnd1]
bnd2 = refmap[bnd2]
</code></pre>
<p>Por último, equiangulamos la malla para ayudar a evitar elementos estrechos,</p>
<pre><code>equiangulate(mesh)
</code></pre>
<p>Una vez que se completa el refinamiento, se puede producir una mayor optimización en la malla recién refinada</p>
<pre><code>opt.conjugategradient(1000)
</code></pre>
<p>El proceso de refinamiento y optimización que acabamos de describir tiene lugar en un bucle. La malla resultante después de 10 iteraciones se muestra en la Fig. <a href="#fig:Electrostatics">7.6</a>, junto con la solución \(\phi\). El código se ejecuta en unos pocos segundos, lo que proporciona una aceleración considerable en comparación con la optimización en una cuadrícula fina para obtener una precisión comparable.</p>
<figure id="fig:Electrostatics">
<div class="centering">
<p><img
src="../Figures/ExamplesChapter/electrostatics/electrostatics-mesh.png"
style="width:3in" alt="image" /><img
src="../Figures/ExamplesChapter/electrostatics/electrostatics-result.png"
style="width:3in" alt="image" /></p>
</div>
<figcaption><span id="fig:Electrostatics"
label="fig:Electrostatics"></span><strong>Electrostatics problem on a
square domain</strong> (left) mesh after 10 iterations of adaptive
refinement and optimization and (right) the resulting solution. Grade 1
elements are shown to emphasize the mesh structure.</figcaption>
</figure>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../examples/dla.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../examples/implicitmesh.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../examples/dla.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../examples/implicitmesh.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
