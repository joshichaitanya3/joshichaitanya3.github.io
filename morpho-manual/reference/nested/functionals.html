<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Functionals - Morpho Manual</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/css/language-picker.css">

        <!-- MathJax -->
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
            TeX: { 
                equationNumbers: { 
                    autoNumber: "AMS",
                }
            }
        });
        </script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../../foreword.html">Foreword</a></li><li class="chapter-item "><a href="../../overview.html"><strong aria-hidden="true">1.</strong> Overview</a></li><li class="chapter-item "><a href="../../installing_morpho.html"><strong aria-hidden="true">2.</strong> Installing Morpho</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../installing/homebrew.html"><strong aria-hidden="true">2.1.</strong> Install with homebrew</a></li><li class="chapter-item "><a href="../../installing/source.html"><strong aria-hidden="true">2.2.</strong> Install with source</a></li><li class="chapter-item "><a href="../../installing/wsl.html"><strong aria-hidden="true">2.3.</strong> Windows via Windows Subsystem for Linux (WSL)</a></li><li class="chapter-item "><a href="../../installing/updating.html"><strong aria-hidden="true">2.4.</strong> Updating morpho</a></li><li class="chapter-item "><a href="../../installing/uninstalling.html"><strong aria-hidden="true">2.5.</strong> Uninstalling morpho</a></li></ol></li><li class="chapter-item "><a href="../../using_morpho.html"><strong aria-hidden="true">3.</strong> Using Morpho</a></li><li class="chapter-item "><a href="../../tutorial.html"><strong aria-hidden="true">4.</strong> Tutorial</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../tutorial/importing_modules.html"><strong aria-hidden="true">4.1.</strong> Importing Modules</a></li><li class="chapter-item "><a href="../../tutorial/morpho_language.html"><strong aria-hidden="true">4.2.</strong> Morpho Language</a></li><li class="chapter-item "><a href="../../tutorial/creating_the_initial_mesh.html"><strong aria-hidden="true">4.3.</strong> Creating the initial mesh</a></li><li class="chapter-item "><a href="../../tutorial/selections.html"><strong aria-hidden="true">4.4.</strong> Selections</a></li><li class="chapter-item "><a href="../../tutorial/fields.html"><strong aria-hidden="true">4.5.</strong> Fields</a></li><li class="chapter-item "><a href="../../tutorial/defining_the_problem.html"><strong aria-hidden="true">4.6.</strong> Defining the problem</a></li><li class="chapter-item "><a href="../../tutorial/performing_the_optimization.html"><strong aria-hidden="true">4.7.</strong> Performing the optimization</a></li><li class="chapter-item "><a href="../../tutorial/visualizing_the_results.html"><strong aria-hidden="true">4.8.</strong> Visualizing the results</a></li><li class="chapter-item "><a href="../../tutorial/refinement.html"><strong aria-hidden="true">4.9.</strong> Refinement</a></li><li class="chapter-item "><a href="../../tutorial/next_steps.html"><strong aria-hidden="true">4.10.</strong> Next steps</a></li></ol></li><li class="chapter-item "><a href="../../working_with_meshes.html"><strong aria-hidden="true">5.</strong> Working with meshes</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../working_with_meshes/meshgen_module.html"><strong aria-hidden="true">5.1.</strong> The meshgen module</a></li><li class="chapter-item "><a href="../../working_with_meshes/meshtools_module.html"><strong aria-hidden="true">5.2.</strong> The meshtools module</a></li><li class="chapter-item "><a href="../../working_with_meshes/vtk_module.html"><strong aria-hidden="true">5.3.</strong> The vtk module</a></li><li class="chapter-item "><a href="../../working_with_meshes/merging_meshes.html"><strong aria-hidden="true">5.4.</strong> Merging meshes</a></li><li class="chapter-item "><a href="../../working_with_meshes/slicing_meshes.html"><strong aria-hidden="true">5.5.</strong> Slicing meshes</a></li></ol></li><li class="chapter-item "><a href="../../visualization.html"><strong aria-hidden="true">6.</strong> Visualization</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../visualization/plot_module.html"><strong aria-hidden="true">6.1.</strong> The plot module</a></li><li class="chapter-item "><a href="../../visualization/graphics_module.html"><strong aria-hidden="true">6.2.</strong> The graphics module</a></li><li class="chapter-item "><a href="../../visualization/povray_module.html"><strong aria-hidden="true">6.3.</strong> The povray module</a></li></ol></li><li class="chapter-item "><a href="../../examples.html"><strong aria-hidden="true">7.</strong> Examples</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../examples/catenoid.html"><strong aria-hidden="true">7.1.</strong> Catenoid</a></li><li class="chapter-item "><a href="../../examples/cholesteric.html"><strong aria-hidden="true">7.2.</strong> Cholesteric</a></li><li class="chapter-item "><a href="../../examples/cube.html"><strong aria-hidden="true">7.3.</strong> Cube</a></li><li class="chapter-item "><a href="../../examples/delaunay.html"><strong aria-hidden="true">7.4.</strong> Delaunay</a></li><li class="chapter-item "><a href="../../examples/dla.html"><strong aria-hidden="true">7.5.</strong> DLA</a></li><li class="chapter-item "><a href="../../examples/electrostatics.html"><strong aria-hidden="true">7.6.</strong> Electrostatics</a></li><li class="chapter-item "><a href="../../examples/implicitmesh.html"><strong aria-hidden="true">7.7.</strong> Implicitmesh</a></li><li class="chapter-item "><a href="../../examples/meshgen.html"><strong aria-hidden="true">7.8.</strong> Meshgen</a></li><li class="chapter-item "><a href="../../examples/meshslice.html"><strong aria-hidden="true">7.9.</strong> Meshslice</a></li><li class="chapter-item "><a href="../../examples/plot.html"><strong aria-hidden="true">7.10.</strong> Plot</a></li><li class="chapter-item "><a href="../../examples/povray.html"><strong aria-hidden="true">7.11.</strong> Povray</a></li><li class="chapter-item "><a href="../../examples/qtensor.html"><strong aria-hidden="true">7.12.</strong> QTensor</a></li><li class="chapter-item "><a href="../../examples/thomson.html"><strong aria-hidden="true">7.13.</strong> Thomson</a></li><li class="chapter-item "><a href="../../examples/wrap.html"><strong aria-hidden="true">7.14.</strong> Wrap</a></li></ol></li><li class="chapter-item expanded "><a href="../../reference.html"><strong aria-hidden="true">8.</strong> Reference</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../reference/language.html"><strong aria-hidden="true">8.1.</strong> Language</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../reference/nested/syntax.html"><strong aria-hidden="true">8.1.1.</strong> Syntax</a></li><li class="chapter-item "><a href="../../reference/nested/values.html"><strong aria-hidden="true">8.1.2.</strong> Values</a></li><li class="chapter-item "><a href="../../reference/nested/variables.html"><strong aria-hidden="true">8.1.3.</strong> Variables</a></li><li class="chapter-item "><a href="../../reference/nested/controlflow.html"><strong aria-hidden="true">8.1.4.</strong> Control Flow</a></li><li class="chapter-item "><a href="../../reference/nested/functions.html"><strong aria-hidden="true">8.1.5.</strong> Functions</a></li><li class="chapter-item "><a href="../../reference/nested/classes.html"><strong aria-hidden="true">8.1.6.</strong> Classes</a></li><li class="chapter-item "><a href="../../reference/nested/modules.html"><strong aria-hidden="true">8.1.7.</strong> Modules</a></li><li class="chapter-item "><a href="../../reference/nested/help.html"><strong aria-hidden="true">8.1.8.</strong> Help</a></li><li class="chapter-item "><a href="../../reference/nested/errors.html"><strong aria-hidden="true">8.1.9.</strong> Errors</a></li><li class="chapter-item "><a href="../../reference/nested/builtin.html"><strong aria-hidden="true">8.1.10.</strong> Built-in Functions</a></li></ol></li><li class="chapter-item "><a href="../../reference/data_types.html"><strong aria-hidden="true">8.2.</strong> Data Types</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../reference/nested/array.html"><strong aria-hidden="true">8.2.1.</strong> Array</a></li><li class="chapter-item "><a href="../../reference/nested/complex.html"><strong aria-hidden="true">8.2.2.</strong> Complex</a></li><li class="chapter-item "><a href="../../reference/nested/list.html"><strong aria-hidden="true">8.2.3.</strong> List</a></li><li class="chapter-item "><a href="../../reference/nested/matrix.html"><strong aria-hidden="true">8.2.4.</strong> Matrix</a></li><li class="chapter-item "><a href="../../reference/nested/range.html"><strong aria-hidden="true">8.2.5.</strong> Range</a></li><li class="chapter-item "><a href="../../reference/nested/sparse.html"><strong aria-hidden="true">8.2.6.</strong> Sparse</a></li><li class="chapter-item "><a href="../../reference/nested/string.html"><strong aria-hidden="true">8.2.7.</strong> String</a></li><li class="chapter-item "><a href="../../reference/nested/tuple.html"><strong aria-hidden="true">8.2.8.</strong> Tuple</a></li></ol></li><li class="chapter-item expanded "><a href="../../reference/computational_geometry.html"><strong aria-hidden="true">8.3.</strong> Computational Geometry</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../reference/nested/field.html"><strong aria-hidden="true">8.3.1.</strong> Field</a></li><li class="chapter-item expanded "><a href="../../reference/nested/functionals.html" class="active"><strong aria-hidden="true">8.3.2.</strong> Functionals</a></li><li class="chapter-item "><a href="../../reference/nested/mesh.html"><strong aria-hidden="true">8.3.3.</strong> Mesh</a></li><li class="chapter-item "><a href="../../reference/nested/selection.html"><strong aria-hidden="true">8.3.4.</strong> Selection</a></li></ol></li><li class="chapter-item "><a href="../../reference/io.html"><strong aria-hidden="true">8.4.</strong> I/O</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../reference/nested/file.html"><strong aria-hidden="true">8.4.1.</strong> File</a></li><li class="chapter-item "><a href="../../reference/nested/json.html"><strong aria-hidden="true">8.4.2.</strong> JSON</a></li></ol></li><li class="chapter-item "><a href="../../reference/modules.html"><strong aria-hidden="true">8.5.</strong> Modules</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../reference/nested/color.html"><strong aria-hidden="true">8.5.1.</strong> Color</a></li><li class="chapter-item "><a href="../../reference/nested/constants.html"><strong aria-hidden="true">8.5.2.</strong> Constants</a></li><li class="chapter-item "><a href="../../reference/nested/delaunay.html"><strong aria-hidden="true">8.5.3.</strong> Delaunay</a></li><li class="chapter-item "><a href="../../reference/nested/graphics.html"><strong aria-hidden="true">8.5.4.</strong> Graphics</a></li><li class="chapter-item "><a href="../../reference/nested/implicitmesh.html"><strong aria-hidden="true">8.5.5.</strong> Implicitmesh</a></li><li class="chapter-item "><a href="../../reference/nested/kdtree.html"><strong aria-hidden="true">8.5.6.</strong> KDTree</a></li><li class="chapter-item "><a href="../../reference/nested/meshgen.html"><strong aria-hidden="true">8.5.7.</strong> MeshGen</a></li><li class="chapter-item "><a href="../../reference/nested/meshslice.html"><strong aria-hidden="true">8.5.8.</strong> MeshSlice</a></li><li class="chapter-item "><a href="../../reference/nested/meshtools.html"><strong aria-hidden="true">8.5.9.</strong> Meshtools</a></li><li class="chapter-item "><a href="../../reference/nested/optimize.html"><strong aria-hidden="true">8.5.10.</strong> Optimize</a></li><li class="chapter-item "><a href="../../reference/nested/plot.html"><strong aria-hidden="true">8.5.11.</strong> Plot</a></li><li class="chapter-item "><a href="../../reference/nested/povray.html"><strong aria-hidden="true">8.5.12.</strong> POVRay</a></li><li class="chapter-item "><a href="../../reference/nested/vtk.html"><strong aria-hidden="true">8.5.13.</strong> VTK</a></li><li class="spacer"></li></ol></li></ol></li><li class="chapter-item "><a href="../../mdbook_notes.html">About this online version</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Morpho Manual</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/joshichaitanya3/morpho-manual" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="functionals"><a class="header" href="#functionals">Functionals</a></h1>
<p>A number of <code>functionals</code> are available in Morpho. Each of these represents an integral over some <code>Mesh</code> and <code>Field</code> objects (on a particular <code>Selection</code>) and are used to define energies and constraints in an <code>OptimizationProblem</code> provided by the <code>optimize</code> module.</p>
<p>Many functionals are built in. Additional functionals are available by importing the <code>functionals</code> module:</p>
<pre><code class="language-javascript">import functionals
</code></pre>
<p>Functionals provide a number of standard methods:</p>
<ul>
<li><code>total</code>(mesh) - returns the value of the integral with a provided mesh, selection and fields</li>
<li><code>integrand</code>(mesh) - returns the contribution to the integral from each element</li>
<li><code>gradient</code>(mesh) - returns the gradient of the functional with respect to vertex motions.</li>
<li><code>fieldgradient</code>(mesh, field) - returns the gradient of the functional with respect to components of the field</li>
</ul>
<p>Each of these may be called with a mesh, a field and a selection.</p>
<h2 id="length"><a class="header" href="#length">Length</a></h2>
<p>A <code>Length</code> functional calculates the length of a line element in a mesh.</p>
<p>Evaluate the length of a circular loop:</p>
<pre><code class="language-javascript">import constants
import meshtools
var m = LineMesh(fn (t) [cos(t), sin(t), 0], 0...2*Pi:Pi/20, closed=true)
var le = Length()
print le.total(m)
</code></pre>
<h2 id="areaenclosed"><a class="header" href="#areaenclosed">AreaEnclosed</a></h2>
<p>An <code>AreaEnclosed</code> functional calculates the area enclosed by a loop of line elements.</p>
<pre><code class="language-javascript">var la = AreaEnclosed()
</code></pre>
<h2 id="area"><a class="header" href="#area">Area</a></h2>
<p>An <code>Area</code> functional calculates the area of the area elements in a mesh:</p>
<pre><code class="language-javascript">var la = Area()
print la.total(mesh)
</code></pre>
<h2 id="volumeenclosed"><a class="header" href="#volumeenclosed">VolumeEnclosed</a></h2>
<p>A <code>VolumeEnclosed</code> functional is used to calculate the volume enclosed by a surface. Note that this estimate may become inaccurate for highly deformed surfaces.</p>
<pre><code class="language-javascript">var lv = VolumeEnclosed()
</code></pre>
<h2 id="volume"><a class="header" href="#volume">Volume</a></h2>
<p>A <code>Volume</code> functional calculates the volume of volume elements.</p>
<pre><code class="language-javascript">var lv = Volume()
</code></pre>
<h2 id="scalarpotential"><a class="header" href="#scalarpotential">ScalarPotential</a></h2>
<p>The <code>ScalarPotential</code> functional is applied to point elements.</p>
<pre><code class="language-javascript">var ls = ScalarPotential(potential)
</code></pre>
<p>You must supply a function (which may be anonymous) that returns the potential. You may optionally provide a function that returns the gradient as well at initialization:</p>
<pre><code class="language-javascript">var ls = ScalarPotential(potential, gradient)
</code></pre>
<p>This functional is often used to constrain the mesh to the level set of a function. For example, to confine a set of points to a sphere:</p>
<pre><code class="language-javascript">import optimize
fn sphere(x,y,z) { return x^2+y^2+z^2-1 }
fn grad(x,y,z) { return Matrix([2*x, 2*y, 2*z]) }
var lsph = ScalarPotential(sphere, grad)
problem.addlocalconstraint(lsph)
</code></pre>
<p>See the thomson example for use of this technique.</p>
<h2 id="linearelasticity"><a class="header" href="#linearelasticity">LinearElasticity</a></h2>
<p>The <code>LinearElasticity</code> functional measures the linear elastic energy away from a reference state.</p>
<p>You must initialize with a reference mesh:</p>
<pre><code class="language-javascript">var le = LinearElasticity(mref)
</code></pre>
<p>Manually set the poisson's ratio and grade to operate on:</p>
<pre><code class="language-javascript">le.poissonratio = 0.2
le.grade = 2
</code></pre>
<h2 id="equielement"><a class="header" href="#equielement">EquiElement</a></h2>
<p>The <code>EquiElement</code> functional measures the discrepency between the size of elements adjacent to each vertex. It can be used to equalize elements for regularization purposes.</p>
<h2 id="linecurvaturesq"><a class="header" href="#linecurvaturesq">LineCurvatureSq</a></h2>
<p>The <code>LineCurvatureSq</code> functional measures the integrated curvature squared of a sequence of line elements.</p>
<h2 id="linetorsionsq"><a class="header" href="#linetorsionsq">LineTorsionSq</a></h2>
<p>The <code>LineTorsionSq</code> functional measures the integrated torsion squared of a sequence of line elements.</p>
<h2 id="meancurvaturesq"><a class="header" href="#meancurvaturesq">MeanCurvatureSq</a></h2>
<p>The <code>MeanCurvatureSq</code> functional computes the integrated mean curvature over a surface.</p>
<h2 id="gausscurvature"><a class="header" href="#gausscurvature">GaussCurvature</a></h2>
<p>The <code>GaussCurvature</code> computes the integrated gaussian curvature over a surface.</p>
<p>Note that for surfaces with a boundary, the integrand is correct only for the interior points. To compute the geodesic curvature of the boundary in that case, you can set the optional flag <code>geodesic</code> to <code>true</code> and compute the total on the boundary selection.
Here is an example for a 2D disk mesh.</p>
<pre><code class="language-javascript">var mesh = Mesh("disk.mesh")
mesh.addgrade(1)
</code></pre>
<pre><code class="language-javascript">var whole = Selection(mesh, fn(x,y,z) true)
var bnd = Selection(mesh, boundary=true)
var interior = whole.difference(bnd)
</code></pre>
<pre><code class="language-javascript">var gauss = GaussCurvature()
print gauss.total(mesh, selection=interior) // expect: 0
gauss.geodesic = true
print gauss.total(mesh, selection=bnd) // expect: 2*Pi
</code></pre>
<h2 id="gradsq"><a class="header" href="#gradsq">GradSq</a></h2>
<p>The <code>GradSq</code> functional measures the integral of the gradient squared of a field. The field can be a scalar, vector or matrix function.</p>
<p>Initialize with the required field:</p>
<pre><code class="language-javascript">var le=GradSq(phi)
</code></pre>
<h2 id="nematic"><a class="header" href="#nematic">Nematic</a></h2>
<p>The <code>Nematic</code> functional measures the elastic energy of a nematic liquid crystal.</p>
<pre><code class="language-javascript">var lf=Nematic(nn)
</code></pre>
<p>There are a number of optional parameters that can be used to set the splay, twist and bend constants:</p>
<pre><code class="language-javascript">var lf=Nematic(nn, ksplay=1, ktwist=0.5, kbend=1.5, pitch=0.1)
</code></pre>
<p>These are stored as properties of the object and can be retrieved as follows:</p>
<pre><code class="language-javascript">print lf.ksplay
</code></pre>
<h2 id="nematicelectric"><a class="header" href="#nematicelectric">NematicElectric</a></h2>
<p>The <code>NematicElectric</code> functional measures the integral of a nematic and electric coupling term integral((n.E)^2) where the electric field E may be computed from a scalar potential or supplied as a vector.</p>
<p>Initialize with a director field <code>nn</code> and a scalar potential <code>phi</code>:</p>
<pre><code class="language-javascript">var lne = NematicElectric(nn, phi)
</code></pre>
<h2 id="normsq"><a class="header" href="#normsq">NormSq</a></h2>
<p>The <code>NormSq</code> functional measures the elementwise L2 norm squared of a field.</p>
<h2 id="lineintegral"><a class="header" href="#lineintegral">LineIntegral</a></h2>
<p>The <code>LineIntegral</code> functional computes the line integral of a function. You supply an integrand function that takes a position matrix as an argument.</p>
<p>To compute <code>integral(x^2+y^2)</code> over a line element:</p>
<pre><code class="language-javascript">var la=LineIntegral(fn (x) x[0]^2+x[1]^2)
</code></pre>
<p>The function <code>tangent()</code> returns a unit vector tangent to the current element:</p>
<pre><code class="language-javascript">var la=LineIntegral(fn (x) x.inner(tangent()))
</code></pre>
<p>You can also integrate functions that involve fields:</p>
<pre><code class="language-javascript">var la=LineIntegral(fn (x, n) n.inner(tangent()), n)
</code></pre>
<p>where <code>n</code> is a vector field. The local interpolated value of this field is passed to your integrand function. More than one field can be used; they are passed as arguments to the integrand function in the order you supply them to <code>LineIntegral</code>.</p>
<p>The gradient of a field is available within an integrand function using the <code>gradient()</code> function.</p>
<h2 id="areaintegral"><a class="header" href="#areaintegral">AreaIntegral</a></h2>
<p>The <code>AreaIntegral</code> functional computes the area integral of a function. You supply an integrand function that takes a position matrix as an argument.</p>
<p>To compute integral(x*y) over an area element:</p>
<pre><code class="language-javascript">var la=AreaIntegral(fn (x) x[0]*x[1])
</code></pre>
<p>You can also integrate functions that involve fields:</p>
<pre><code class="language-javascript">var la=AreaIntegral(fn (x, phi) phi^2, phi)
</code></pre>
<p>The local facet normal can be accessed in an integrand using the <code>normal()</code> function:</p>
<pre><code class="language-javascript">var la=AreaIntegral(fn (x) x.inner(normal())^2)
</code></pre>
<p>More than one field can be used; they are passed as arguments to the integrand function in the order you supply them to <code>AreaIntegral</code>.</p>
<p>The gradient of a field is available within an integrand function using the <code>gradient()</code> function.</p>
<h2 id="volumeintegral"><a class="header" href="#volumeintegral">VolumeIntegral</a></h2>
<p>The <code>VolumeIntegral</code> functional computes the volume integral of a function. You supply an integrand function that takes a position matrix as an argument.</p>
<p>To compute integral(x<em>y</em>z) over an volume element:</p>
<pre><code class="language-javascript">var la=VolumeIntegral(fn (x) x[0]*x[1]*x[2])
</code></pre>
<p>You can also integrate functions that involve fields:</p>
<pre><code class="language-javascript">var la=VolumeIntegral(fn (x, phi) phi^2, phi)
</code></pre>
<p>More than one field can be used; they are passed as arguments to the integrand function in the order you supply them to <code>VolumeIntegral</code>.</p>
<p>The gradient of a field is available within an integrand function using the <code>gradient()</code> function.</p>
<h2 id="hydrogel"><a class="header" href="#hydrogel">Hydrogel</a></h2>
<p>The <code>Hydrogel</code> functional computes the Flory-Rehner energy over an element:</p>
<pre><code class="language-javascript">(a*phi*log(phi) + b*(1-phi)+log(1-phi) + c*phi*(1-phi))*V + 
d*(log(phiref/phi)/3 - (phiref/phi)^(2/3) + 1)*V0
</code></pre>
<p>The first three terms come from the Flory-Huggins mixing energy, whereas
the fourth term proportional to d comes from the Flory-Rehner elastic
energy.</p>
<p>The value of phi is calculated from a reference mesh
that you provide on initializing the Functional:</p>
<pre><code class="language-javascript">var lfh = Hydrogel(mref)
</code></pre>
<p>Here, a, b, c, d and phiref are parameters you can supply (they are <code>nil</code>
by default), V is the current volume and V0 is the reference volume of a
given element. You also need to supply the initial value of phi, labeled
as phi0, which is assumed to be the same for all the elements.
Manually set the coefficients and grade to operate on:</p>
<pre><code class="language-javascript">lfh.a = 1; lfh.b = 1; lfh.c = 1; lfh.d = 1;
lfh.grade = 2, lfh.phi0 = 0.5, lfh.phiref = 0.1
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../reference/nested/field.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../reference/nested/mesh.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../reference/nested/field.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../reference/nested/mesh.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
